<!-- REVISED INTRODUCTION â€” trimmed from ~1087 to ~790 words for PNAS -->
<!-- Revision: merged P1+P2, trimmed P3 (cut rank-selection pre-emption), trimmed P4 (cut BO/alpha-0 detail) -->
<!-- Citation keys used in this file: -->
<!--   collisson2011subtypes, nguyen2024fourteen, lee1999learning, moffitt2015virtual, -->
<!--   peng2019novo, brunet2004metagenes, Bailey2016, bair2004semi, cook2007fisher, -->
<!--   rashid2020purity, peng2024determination, Schwarzova2023, collisson2019molecular, -->
<!--   bair2006supervised, arora2020survclust, aran2015systematic, -->
<!--   huang2020low, le2025survnmf, damrauer2014intrinsic, Hoadley2018, -->
<!--   gaujoux2010flexible -->
<!-- Citation keys removed from intro (still used elsewhere in paper): -->
<!--   frigyesi2008nmf (in Results), -->
<!--   snoek2012practical (in Methods/SI), tishby1999information (in Discussion), -->
<!--   chapelle2006semi (in Discussion) -->

Predicting which cancer patients will respond to therapy or progress rapidly requires identifying the transcriptional signatures that drive clinical outcomes [@collisson2011subtypes]. Yet in bulk RNA-sequencing, which currently provides the large clinically annotated cohorts required for survival modeling, the observed expression profile of each sample reflects contributions from malignant cells, cancer-associated fibroblasts, immune infiltrates, and other microenvironmental components [@nguyen2024fourteen]. Nonnegative matrix factorization (NMF) has been instrumental in resolving this mixture into additive, interpretable gene programs corresponding to recognizable cell types or transcriptional states [@lee1999learning; @moffitt2015virtual; @peng2019novo], yielding important biological insights including the identification of basal-like and classical tumor programs in pancreatic ductal adenocarcinoma (PDAC) [@collisson2011subtypes; @moffitt2015virtual] and compartment-specific deconvolution across 33 cancer types [@peng2019novo].

However, the standard approach discovers these programs through unsupervised factorization and only then evaluates their clinical relevance retrospectively [@brunet2004metagenes; @Bailey2016]. Because unsupervised NMF minimizes reconstruction error, its factors tend to be dominated by the highest-variance patterns in the data, which may reflect tissue composition or other outcome-neutral sources rather than prognostic biology [@bair2004semi; @cook2007fisher]. In PDAC, exocrine and tissue-composition signals dominate expression variance but contribute little to survival prediction, while lower-variance basal-like and activated stromal programs carry the strongest prognostic associations [@moffitt2015virtual; @rashid2020purity; @peng2024determination]; programs that are prognostically relevant but explain modest variance can be diluted across multiple factors or missed entirely. This misalignment between variance and prognosis extends beyond PDAC: tumor purity alone accounts for a large fraction of expression variation across cancer types [@aran2015systematic], yet the objective optimized during unsupervised discovery (reconstruction error) differs fundamentally from the criterion used during evaluation (survival association) [@cook2007fisher]. Identifying the prognostically relevant subset then requires extensive downstream filtering that is ad hoc, cohort-specific, and difficult to reproduce [@collisson2019molecular]. Over a decade of PDAC subtyping efforts proposed between two and six subtypes [@Schwarzova2023; @collisson2019molecular], ultimately converging on a robust basal/classical dichotomy only after extensive retrospective evaluation across independent cohorts [@collisson2011subtypes; @Bailey2016; @rashid2020purity].

Whether incorporating survival information during factorization improves generalizability, or risks overfitting to cohort-specific outcome distributions, remains an open empirical question. Sufficient dimension reduction theory establishes that response-guided subspace estimation targets the directions most relevant to the outcome, whereas variance-maximizing projections can miss outcome-relevant structure entirely [@cook2007fisher; @bair2006supervised]. When the outcome depends on cell populations that are compositionally minor or contribute low variance to bulk expression, unsupervised methods systematically miss these features, while outcome-supervised methods can recover them [@bair2004semi; @bair2006supervised; @arora2020survclust]. Supervision during factorization would filter out variance-dominant but prognostically neutral signals during learning rather than in a separate post hoc step, but whether this theoretical advantage translates to improved generalization in the NMF deconvolution setting, where nonnegative constraints, censored survival outcomes, and cohort-specific variation introduce additional challenges, has not been empirically tested.

Here we present DeSurv, a survival-supervised deconvolution framework that integrates NMF with Cox proportional hazards modeling. The key architectural choice is where survival supervision enters the factorization. In DeSurv, factor scores are defined as $Z = W^\top X$, so the Cox partial likelihood is a function of the gene program matrix $W$ and regression coefficients $\beta$, and the survival gradient acts directly on gene programs. Sample-level loadings $H$ are updated solely through the reconstruction objective and receive no survival gradient, preserving their interpretation as mixture coefficients [@lee1999learning; @gaujoux2010flexible] and the biological interpretability of the deconvolution. DeSurv operates as a semi-supervised method: a parameter $\alpha$ balances reconstruction fidelity ($1-\alpha$) and survival prediction ($\alpha$). Because $\alpha$ is selected via cross-validated concordance, values large enough to overfit to cohort-specific survival patterns are penalized by poor out-of-sample performance, preventing the survival term from overwhelming the factorization. Because $W$ defines shared transcriptomic programs, new samples can be scored by projection ($Z_{\text{new}} = W^\top X_{\text{new}}$) without requiring their survival data, a property not shared by methods that route supervision through $H$ [@huang2020low; @le2025survnmf]. Hyperparameters, including factorization rank $k$ and $\alpha$, are jointly selected via cross-validated concordance (Methods).

We evaluate DeSurv in three settings that test the predictions above. First, in simulations with known latent structure and survival associations, we show that DeSurv recovers the true factorization rank and the identity of prognostic programs more reliably than standard NMF, that its advantage scales with the degree of divergence between variance and prognosis, and that it vanishes under null conditions where no survival signal exists. Second, in PDAC, we demonstrate that survival supervision reorganizes the learned factor structure: DeSurv suppresses variance-dominant but prognostically neutral signals (e.g., exocrine content) and concentrates survival association into a smaller set of biologically interpretable factors aligned with known tumor and microenvironmental programs. These survival-aligned factors generalize across independent PDAC cohorts with consistent hazard ratios and clearer survival separation than their unsupervised counterparts. Third, we show that a PDAC-trained DeSurv factor retains prognostic signal when projected into bladder cancer samples, consistent with prior reports that basal-like transcriptional structure generalizes across epithelial cancers [@damrauer2014intrinsic; @Hoadley2018].
