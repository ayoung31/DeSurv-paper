## Data Processing  
We analyzed publicly available RNA-seq and microarray cohorts of pancreatic ductal adenocarcinoma (PDAC) and bladder cancer with corresponding overall survival outcomes. Gene expression matrices were converted to TPM, log-transformed, and filtered to remove low-expression genes. Survival times and censoring indicators were taken from the associated clinical annotations. Of the seven PDAC cohorts we considered, two were used for training (TCGA and CPTAC) and the rest were used for external validation (Dijk, Moffitt, PACA, Puleo). The bladder cohort was split into training and validation cohorts via a 70/30 split. To harmonize differences in scale across cohorts, filtered gene expression data was within-subject rank transformed before model training. More details about the datasets can be found in the SI Appendix.

## The DeSurv Method  
DeSurv integrates Nonnegative Matrix Factorization (NMF) with penalized Cox regression to identify gene programs associated with patient survival. Let $X \in \mathbb{R}^{p \times n}_{\ge 0}$ denote the nonnegative expression matrix. DeSurv approximates $X \approx WH$, where $W \in \mathbb{R}^{p\times k}_{\ge0}$ contains nonnegative gene programs and $H \in \mathbb{R}^{k\times n}_{\ge0}$ contains sample-level activations. Survival information is incorporated through factor signature scores $Z = W^\top X$, enabling the Cox model to directly influence the learned programs.

The joint objective is  
\[
\mathcal{L}(W,H,\beta) =
(1-\alpha)\,\mathcal{L}_{\mathrm{NMF}}(W,H)
- \alpha\,\mathcal{L}_{\mathrm{Cox}}(W,\beta),
\]
where  
\[
\mathcal{L}_{\mathrm{NMF}}(W,H)
= \frac{1}{np}\|X-WH\|_F^2
+ \frac{\lambda_H}{nk}\|H\|_F^2,
\]
and $\mathcal{L}_{\mathrm{Cox}}(W,\beta)$ is the elastic-net penalized partial log-likelihood. Optimization proceeds by alternating updates for $H$, $W$, and $\beta$, using multiplicative rules for $H$ [@lee1999], projected gradients for $W$, and coordinate descent for $\beta$. Although non-convex, these updates are shown to converge to a stationary point under mild conditions (SI Appendix). Complete derivations and algorithmic details are provided in the SI Appendix.

## Model Training and Evaluation  
Hyperparameters $(k,\alpha,\lambda_H,\lambda,\xi)$ were selected by maximizing the cross-validated C-index using Bayesian optimization. Each fold was trained using multiple random initializations, and fold-level performance was defined as the average C-index across initializations. For stability, we used a consensus-based initialization for the final model, aggregating multiple DeSurv runs into a gene--gene co-occurrence matrix and constructing an initialization $W_0$ from the resulting clusters (SI Appendix). Before validation, each column of $W$ was truncated to its BO-selected number of top genes (details in SI Appendix), denoted $\tilde{W}$. External validation was performed by first projecting new datasets onto the learned programs via $Z = \tilde{W}^\top X_{\text{new}}$ and evaluating survival associations using C-index and log-rank statistics. To evaluate the quality of the DeSurv derived gene signatures for subtyping, the new datasets $X_new$ were clustered on genes in $\tilde{W}, and survival differences were analyzed for the derived clusters. Further training, validation, and runtime details appear in the SI Appendix.

## Simulations, Benchmarking, and Availability  
Simulations were conducted to assess factor recovery, robustness, and survival prediction under varying signal and noise settings, with comparisons to the two-step standard NMF + cox model and other dimension-reduction baselines. Full simulation designs and all benchmarking procedures are provided in the SI Appendix. Code and processed data used in this study are available at [repository link].
