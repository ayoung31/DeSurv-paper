---
title: Survival driven deconvolution (DeSurv) reveals prognostic and interpretable cancer subtypes
  # Use letters for affiliations, numbers to show equal authorship (if applicable) and to indicate the corresponding authors
author:
  - name: Amber M. Young
    affiliation: a,1,2
  - name: Alisa Yurovsky
    affiliation: b
  - name: Didong Li
    affiliation: a
  - name: Naim U. Rashid
    affiliation: a,c
address:
  - code: a
    address: University of North Carolina at Chapel Hill, Biostatistics, Street, City, State, Zip
  - code: b
    address: Stony Brook University, Street, City, State, Zip

corresponding_author:
  code: 2
  text: "To whom correspondence should be addressed. E-mail: ayoung31@live.unc.edu"

# For footer text
lead_author_surname: Anonymous


author_contributions: |
  Please provide details of author contributions here.

## Remove this if not required
conflict_of_interest: |
  Please declare any conflict of interest here.

abstract: |
  Molecular subtyping in cancer is an ongoing problem that relies on the identification of robust and replicable gene signatures. While transcriptomic profiling has revealed recurrent gene expression patterns in various types of cancer, the prognostic value of these signatures is typically evaluated in retrospect. This is due to the reliance on unsupervised learning methods for identifying cell-type-specific signals and clustering patients into molecular subtypes. Here we present a Survival-driven Deconvolution tool (DeSurv) that integrates bulk RNA-sequencing data with patient survival information to identify cell-type-enriched gene signatures associated with prognosis. Applying DeSurv to various cohorts in pancreatic cancer, we uncover prognostic and biologically interpretable subtypes that reflect the complex interactions between stroma, tumor, and immune cells in the tumor microenvironment. Our approach highlights the value of using patient outcomes during gene signature discovery.

significance: |
  Tumor transcriptomes mix malignant and microenvironmental signals, making it difficult to identify programs that drive clinical outcomes. Existing deconvolution and matrix factorization methods discover latent programs but do not ensure prognostic relevance, while supervised predictors often sacrifice biological interpretability. We present DeSurv, a survival-supervised deconvolution framework that integrates nonnegative matrix factorization with Cox modeling to learn gene programs and their survival associations jointly. By embedding outcome information into discovery and using automatic model selection, DeSurv yields clinically relevant, reproducible programs across cohorts. This advances tumor deconvolution and provides a general tool for identifying actionable drivers of disease progression.

acknowledgements: |
  Please include your acknowledgments here, set in a single paragraph. Please do not include any acknowledgments in the Supporting Information, or anywhere else in the manuscript.

keywords:
  - nonnegative matrix factorization
  - survival analysis
  - semi-supervised learning
  - tumor deconvolution
  - pancreatic cancer

params:
  tar_store: "store_PKG_VERSION=20260107bugfix_GIT_BRANCH=main"
  bo_label: ~
  run_label: ~
  val_label: ~

## must be one of: pnasresearcharticle (usual two-column layout), pnasmathematics (one column layout), or pnasinvited (invited submissions only)
pnas_type: pnasresearcharticle

bibliography: references_30102025.bib
csl: pnas.csl

## change to true to add optional line numbering
lineno: false

output: rticles::pnas_article

header-includes:
  - \providecommand{\pandocbounded}[1]{#1}
  - \usepackage{booktabs}
  - \usepackage{float}
  - \usepackage{graphicx}
  - \usepackage{amsmath}
  - \usepackage{amsfonts}
  - \usepackage{amssymb}
  - \usepackage{bbm}
  - \usepackage{algorithm}
  - \usepackage{algpseudocode}
  - \usepackage{setspace} 
  - \DeclareMathOperator*{\argmin}{argmin}
  - \DeclareMathOperator*{\argmax}{argmax}
  - \DeclareMathOperator\diag{diag}
  - \renewcommand{\algorithmicrequire}{\textbf{Input:}}
  - \renewcommand{\algorithmicensure}{\textbf{Output:}}
---
```{r, echo=FALSE}
knitr::opts_chunk$set(
  echo    = FALSE,   # show code (set FALSE to hide)
  message = FALSE,  # suppress package startup messages
  warning = FALSE,  # suppress warnings
  error   = FALSE,  # suppress errors in output
  fig.align = "center" # center figures
)

if (requireNamespace("ggplot2", quietly = TRUE)) {
  ggplot2::theme_set(ggplot2::theme_gray(base_size = 10))
}

set_fig_font <- function(plot_obj, size = 10) {
  if (inherits(plot_obj, "ggplot")) {
    plot_obj + ggplot2::theme(text = ggplot2::element_text(size = size))
  } else {
    plot_obj
  }
}

```

```{r targets-store, include=FALSE}
library(targets)
tar_store <- if (exists("params", inherits = TRUE)) params$tar_store else NULL
if (!is.null(tar_store) && nzchar(tar_store)) {
  tar_config_set(store = tar_store)
}
```



```{r child="02_introduction_REVISED.Rmd"}

```

# Results {.unnumbered}

```{r child="04_results_REVISED.Rmd"}

```

# Discussion {.unnumbered}

```{r child="05_discussion_REVISED.Rmd"}

```

# Materials and methods {.unnumbered}

```{r child="03_methods_REVISED.Rmd"}

```




<!-- Leave these lines as they are at the end of your .Rmd file to ensure placement of methods & acknowledgements sections before the references-->
\showmatmethods
\showacknow


\pnasbreak

# Versioning {.unnumbered}

```{r versioning, echo=FALSE}
version_info <- tryCatch(
  targets::tar_read("version_info"),
  error = function(e) NULL
)

if (is.null(version_info)) {
  desurv_version <- tryCatch(
    as.character(utils::packageVersion("DeSurv")),
    error = function(e) "unknown"
  )
  desurv_repo <- normalizePath("../DeSurv", mustWork = FALSE)
  desurv_branch <- tryCatch(
    if (dir.exists(desurv_repo)) {
      trimws(system(
        sprintf("git -C %s rev-parse --abbrev-ref HEAD", shQuote(desurv_repo)),
        intern = TRUE,
        ignore.stderr = TRUE
      ))
    } else {
      "unknown"
    },
    error = function(e) "unknown"
  )
  desurv_commit <- tryCatch(
    if (dir.exists(desurv_repo)) {
      trimws(system(
        sprintf("git -C %s rev-parse HEAD", shQuote(desurv_repo)),
        intern = TRUE,
        ignore.stderr = TRUE
      ))
    } else {
      "unknown"
    },
    error = function(e) "unknown"
  )
  paper_branch <- tryCatch(
    trimws(system("git rev-parse --abbrev-ref HEAD", intern = TRUE, ignore.stderr = TRUE)),
    error = function(e) "unknown"
  )
  paper_commit <- tryCatch(
    trimws(system("git rev-parse HEAD", intern = TRUE, ignore.stderr = TRUE)),
    error = function(e) "unknown"
  )
} else {
  desurv_version <- version_info$desurv_pkg_version
  desurv_branch <- version_info$desurv_git_branch
  desurv_commit <- version_info$desurv_git_commit
  paper_branch <- version_info$paper_git_branch
  paper_commit <- version_info$paper_git_commit
}

if (!length(desurv_version) || !nzchar(desurv_version)) desurv_version <- "unknown"
if (!length(desurv_branch) || !nzchar(desurv_branch)) desurv_branch <- "unknown"
if (!length(desurv_commit) || !nzchar(desurv_commit)) desurv_commit <- "unknown"
if (!length(paper_branch) || !nzchar(paper_branch)) paper_branch <- "unknown"
if (!length(paper_commit) || !nzchar(paper_commit)) paper_commit <- "unknown"

cat(
  "DeSurv package version: ", desurv_version, "\n",
  "DeSurv git branch: ", desurv_branch, "\n",
  "DeSurv git commit: ", desurv_commit, "\n",
  "Paper git branch: ", paper_branch, "\n",
  "Paper git commit: ", paper_commit, "\n",
  sep = ""
)
```
