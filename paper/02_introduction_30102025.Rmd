Molecular subtyping has transformed precision oncology by stratifying patients into biologically and clinically meaningful groups that inform prognosis and guide therapy [@pareja2016triple; @dienstmann2018molecular; @zhou2021clinical; @seiler2017impact; @prat2015clinical]. Subtyping relies on the identification of robust biological signals that define subtypes such as transcriptomic signatures. However, the tumor microenvironment (TME) contains mixtures of diverse cell types such as malignant, stromal, immune, and endothelial cells, and disentangling tumor specific signals from this mixture can be challenging. As such, subtyping pipelines typically rely on the deconvolution of bulk transcriptomic data or single-cell analysis to discover distinct cell types and their corresponding signatures. Downstream, the signatures are evaluated for clinical relevance such as overall survival or response to treatment. 

Separating discovery from validation can risk overfitting and limits biological and clinical generalizability. Identified cell types may capture dataset-specific noise rather than reproducible biological signals, undermining their utility in downstream analyses or therapeutic targeting [@Ou2021, @Planey2016]. Moreover, even when discovered cell types are biologically valid and reproducible, they may not correspond to the cellular programs most relevant for predicting or influencing clinical outcomes [@Prat2014, @ellrott2025classification]. Therefore, there is a clear need for integrative methods that jointly uncover biologically meaningful programs while directly incorporating clinical endpoints to ensure prognostic relevance.

However, integrating patient outcomes into the discovery phase is not straightforward with current technology and methodology. Single-cell transcriptomics can resolve programs at the cellular level, but cohort sizes are often too small to support survival analyses. In contrast, large bulk transcriptomic cohorts with clinical annotations are well-suited for outcome modeling [@tomczak2015review; @zhang2019international], yet deconvolution is needed to disentangle overlapping cellular signals. Reference-based deconvolution methods focus on estimating cell-type proportions from predefined signatures, which limits the utility of these methods for discovery of novel programs [@nguyen2024fourteen]. 

Nonnegative matrix factorization (NMF) is widely used in cancer genomics because its nonnegativity constraints produce biologically interpretable, additive molecular programs \citep{lee1999learning, Bailey2016, moffitt2015virtual, peng2019novo}. Although recent extensions have incorporated supervision into the factorization, most target regression or classification rather than time-to-event outcomes. Two studies have proposed survival-aware NMF formulations \citep{le2025survnmf, huang2020low}, but both integrate the survival objective through the sample-specific loadings rather than the gene-level programs. This design emphasizes prediction accuracy but limits the model’s ability to restructure or refine the underlying molecular programs, reducing its value for biological interpretation and subtype discovery, which are core objectives in cancer transcriptomics. In addition, neither study provides a principled approach for hyperparameter selection or model assessment, and convergence properties are only briefly addressed in one manuscript. Both works remain unpublished and unreviewed, leaving their methodological robustness and reproducibility uncertain. These gaps highlight the need for a rigorously formulated, survival-aware deconvolution method that jointly estimates interpretable molecular programs and their prognostic relevance.

Here we present DeSurv, a Survival-supervised Deconvolution framework that integrates non-negative matrix factorization (NMF) with Cox proportional hazards modelling. In contrast to fully unsupervised approaches that evaluate survival associations only after the factorization, and to existing supervised NMF models that link outcomes to the subject-level factor loadings, DeSurv integrates survival information directly into the gene signature matrix. This design ensures that the discovered transcriptional programs are not only biologically interpretable but also intrinsically aligned with patient outcomes. To enhance robustness and reproducibility, DeSurv performs automatic parameter selection via Bayesian optimization, addressing the quintessential challenge of rank determination in matrix factorization.

By coupling latent program discovery with direct survival supervision, DeSurv resolves longstanding challenges in disentangling tumor–microenvironment interactions and aligns molecular heterogeneity with clinical outcomes. This unified approach represents a methodological advance in translational cancer genomics and provides a general framework for deriving actionable insights from high-dimensional transcriptomic data.





<!-- To benchmark DeSurv’s ability to recover prognostic signals, we first evaluated its performance on synthetic datasets that simulate mixtures of tumor and stromal programs with known survival associations. These simulations allowed us to control the degree of signal entanglement, subtype overlap, and censoring rates. DeSurv consistently identified latent programs that aligned with the ground truth survival drivers, outperforming standard NMF followed by downstream Cox regression in both accuracy and stability. Importantly, we observed that incorporating survival supervision during factorization not only improved risk stratification (as measured by concordance index and log-rank p-values) but also enhanced interpretability, producing factor loadings more closely aligned with the true cell-type contributions. Across a range of noise levels and signal sparsity, DeSurv maintained robust performance, highlighting its utility for disentangling prognostically informative programs even under challenging conditions. -->

<!-- We demonstrate DeSurv on PDAC, a cancer type that has historically resisted consensus on molecular subtypes due to overlapping tumor and stromal signals. DeSurv not only recapitulates the classical–basal-like axis but also reveals prognostic gradients driven by cancer-associated fibroblast (CAF) subtypes. These blended programs align with single-cell–derived CAF phenotypes—including inflammatory, myofibroblastic, and antigen-presenting states—and stratify survival more effectively than previous classifiers developed from tumor or stroma alone [@ohlund2017distinct; @elyada2019cross]. We further extend our analysis to bladder cancer, where subtyping efforts have identified basal, luminal, neuroendocrine-like, and stroma-rich categories [@Fong2020; @Sjodahl2019; @Kamoun2019]. However, variability in tumor purity and classifier definitions has hindered reproducibility [@Schwarzova2023; @Warrick2021]. DeSurv identifies coherent stromal and immune programs that refine these subtypes and improve survival stratification across cohorts [@Sanguedolce2022; @Lindskrog2021; @Lopez2023]. -->


<!-- Additionally, interactions between tumor and other microenvironmental components has been shown to drive prognosis. Yet in many solid tumors, efforts to define tumor-intrinsic and stromal programs have proceeded independently, making it difficult to understand how their interactions shape disease progression.  -->

<!-- This limitation is particularly evident in pancreatic ductal adenocarcinoma (PDAC), where a decade of research produced conflicting schemes describing both the number and characterization of tumor and stromal subtypes [@collisson2011subtypes, @bailey2016, @moffitt2015virtual,@elyada2019cross,@Maurer2019, @Chen2021, @Wang2021].  -->

<!-- Only retrospectively did the field coalesce around a clinically relevant basal-like/classical tumor dichotomy after evaluating the prognostic significance of each schema [@rashid2020purity]. More recently, Peng et al. (2024) showed that a two subtype stromal schema was prognostically informative and the interaction of tumor and stroma further differentiates survival outcomes [@peng2024determination]. This highlights the need for models that directly capture these effects rather than relying on post-hoc evaluation. -->

