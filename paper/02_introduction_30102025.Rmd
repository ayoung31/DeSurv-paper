Molecular subtyping has become a cornerstone of precision oncology, enabling the classification of patients into biologically distinct groups that inform prognosis and guide therapeutic decisions [@pareja2016triple;@dienstmann2018molecular;@zhou2021clinical;@seiler2017impact;@prat2015clinical]. Defining these subtypes depends on identifying robust genomic or transcriptomic signatures that capture the molecular programs driving disease heterogeneity [@bertucci2005gene;@jezequel2015gene;@marisa2013gene;@collisson2019molecular]. 

However, tumors are composed of diverse cell types—including malignant, stromal, immune, and endothelial populations—whose gene-expression signals are deeply interwoven. This complexity makes it difficult to isolate the signatures that truly characterize each subtype or to distinguish tumor-intrinsic programs from those shaped by the surrounding microenvironment. Furthermore, some molecular programs may delineate distinct aspects of tumor biology but not demonstrate clinical relevance with respect to patient outcomes [@hoadley2014multiplatform;@tirosh2016dissecting;@rashid2020purity]. This disconnect highlights a key challenge in translational genomics: distinguishing the molecular features that merely describe tumor heterogeneity from those that are predictive of disease course or therapeutic response.

Single-cell transcriptomic technologies have transformed our understanding of tumor ecosystems by resolving the diversity of cell types and states within the tumor microenvironment @ren2021insights. Yet their high cost and limited cohort sizes often preclude systematic evaluation of clinical outcomes, so the molecular programs they uncover are typically assessed downstream in bulk datasets for prognostic or therapeutic relevance. Bulk transcriptomic studies—while lacking cellular resolution—have been conducted across many independent patient cohorts, which collectively encompass hundreds to thousands of clinically annotated samples [@tomczak2015review;@zhang2019international]. These datasets provide the statistical power to evaluate molecular programs in relation to patient outcomes, highlighting a trade-off between biological resolution and clinical scalability.

To address the limited resolution of bulk data, numerous computational deconvolution approaches have been developed to infer the relative abundance of distinct cell types and their gene-expression programs, summarized in this review @nguyen2024fourteen. These methods often rely on reference signatures derived from sorted or single-cell data to estimate cellular composition and attribute gene-expression patterns to known cell types. While such approaches have been valuable for characterizing the tumor microenvironment, they depend on predefined references and therefore cannot discover new or context-specific molecular programs.

Unsupervised matrix factorization methods, particularly Nonnegative Matrix Factorization (NMF) @lee1999learning, have been instrumental in revealing latent molecular programs that define tumor heterogeneity, especially in pancreatic cancer [@Bailey2016;@collisson2011subtypes;@moffitt2015virtual;@peng2019novo]. NMF excels at identifying biologically meaningful patterns in gene-expression data @brunet2004metagenes but is limited in prognostic ability due to its unsupervised nature @bair2004semi. Additionally, the non-uniqueness of NMF solutions can make replicability across studies challenging. Consequently, the uncovered programs frequently capture broad biological variation, such as cell type composition, rather than the specific molecular features that influence prognosis or treatment response. 

To bridge this gap, we introduce DeSurv, a semi-supervised deconvolution framework that integrates NMF with the Cox proportional hazards model @cox1972regression. By integrating survival modeling directly into the matrix factorization framework, DeSurv learns de novo molecular programs that are both biologically interpretable and prognostic of patient outcomes. Importantly, DeSurv incorporates an automated cross-validation framework to determine key parameters, including the optimal number of latent factors—addressing a major limitation of fully unsupervised approaches that rely on heuristic or subjective choices. Applied to pancreatic adenocarcinoma (PDAC) data, DeSurv uncovered molecular programs representing blended tumor, stromal, and immune features, suggesting that integrating survival information can reveal novel prognostic interactions between tumor and microenvironmental processes.
