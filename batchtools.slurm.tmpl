#!/bin/bash
# -- Slurm header -------------------------------------------------------------
#SBATCH --job-name=<%= job.name %>
#SBATCH --output=<%= log.file %>
#SBATCH --time=<%= resources$walltime %>        # e.g. 01:00:00
#SBATCH --cpus-per-task=<%= resources$cpus %>   # threads per job
#SBATCH --mem=<%= resources$mem %>              # e.g. 8G, 32000M
<% if (!is.null(resources$account)) { %>
#SBATCH --account=<%= resources$account %>
<% } %>

# -- optional: modules / env --------------------------------------------------
<% if (!is.null(resources$modules)) { %>
module load <%= paste(resources$modules, collapse=" ") %>
<% } %>
export OMP_NUM_THREADS=<%= resources$cpus %>
export MKL_NUM_THREADS=<%= resources$cpus %>

# -- run the R job ------------------------------------------------------------
Rscript -e 'batchtools::doJobCollection("<%= uri %>")'
