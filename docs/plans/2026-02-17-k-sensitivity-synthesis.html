<style>body{max-width:1400px;margin:0 auto;padding:20px;font-family:sans-serif;font-size:13px;line-height:1.5}table{border-collapse:collapse;width:100%;margin:1em 0;white-space:nowrap}th,td{border:1px solid #ddd;padding:4px 8px;text-align:left}th{background:#f5f5f5;font-weight:bold}tr:nth-child(even){background:#fafafa}h1{font-size:1.5em}h2{font-size:1.25em;border-bottom:1px solid #ccc;padding-bottom:4px}h3{font-size:1.1em}code{background:#f0f0f0;padding:1px 4px;border-radius:2px;font-size:12px}pre{background:#f0f0f0;padding:8px;overflow-x:auto;font-size:12px}</style>
<h1 id="desurv-k-sensitivity-synthesis-the-icaf-coherence-story">DeSurv
K-Sensitivity Synthesis: The iCAF Coherence Story</h1>
<p><strong>For discussion with Jen Jen Yeh</strong> <strong>Date:
2026-02-17</strong> <strong>Companion documents:</strong> -
<code>2026-02-17-jjy-talking-points-k3-grid.md</code> (K=3 factor
analysis) - <code>2026-02-17-jjy-talking-points-k2-grid.md</code> (K=2
factor analysis) - <code>2026-02-17-jjy-talking-points-k5-grid.md</code>
(K=5 factor analysis)</p>
<p><strong>Note for Amber:</strong> This synthesis document pulls
together findings from the three companion documents above. It uses the
cv_grid exhaustive search fits instead of the BO-selected production
fit, holding lambda, nu, and ntop constant so we can do a controlled
comparison across K and alpha. See the glossary at the end for term
definitions. The analysis scripts are in
<code>inst/cv_grid_training_analysis.R</code> (training) and
<code>inst/cv_grid_validation_analysis.R</code> (validation). Run from
the repo root.</p>
<hr />
<h2 id="executive-summary">Executive Summary</h2>
<p>We fit DeSurv across K=2, 3, 5 and alpha=0, 0.25/0.35, 0.55 using the
cv_grid exhaustive search, with <strong>all hyperparameters except K and
alpha held constant</strong> (lambda=0.3, nu=0.05, 100 initializations,
ntop=NULL). This is an apples-to-apples comparison that eliminates the
confound in the previous analysis where different K values used
different BO-selected hyperparameters.</p>
<p><strong>All results are validated in 570 independent
patients</strong> across 4 external cohorts (Dijk, Moffitt GEO, Puleo,
PACA-AU), using <code>strata(dataset)</code> to account for
cohort-specific baseline hazards and adjusting for PurIST + DeCAF
classifiers.</p>
<p>The central finding: <strong>The iCAF program is alpha-dependent, not
just K-dependent.</strong> At alpha=0 (standard NMF), no value of K
recovers the iCAF program. The survival penalty creates it. Among all K
x alpha combinations tested, K=3 at alpha&gt;=0.35 uniquely produces a
single coherent iCAF factor that is the sole survival signal <strong>and
validates in external data</strong>.</p>
<h3 id="what-icaf-means-in-this-document">What “iCAF” means in this
document</h3>
<p>Throughout, “iCAF program” refers to the factor that best matches the
<strong>original production K=3 Factor 1</strong> (from the BO-selected
fit with alpha=0.334, lambda=0.349, nu=0.056, ntop=270). That factor was
characterized as iCAF-associated based on:</p>
<ol type="1">
<li><p><strong>Elyada et al. (2019) iCAF 35-gene signature</strong>,
from single-cell RNA-seq of PDAC cancer-associated fibroblasts. 25 of 35
genes present in the 1970-gene universe (see Glossary for “universe”
definition). Key genes: PLA2G2A, DPT, CXCL14, PI16, CCDC80, FSTL1, PTX3,
FBLN2, TNXB, SOD2, APOE, FBLN1, ADH1B, GPX3.</p></li>
<li><p><strong>SCISSORS iCAF 25-gene signature</strong>, from Raghavan
et al. (2021). 17 of 25 present in the gene universe. Key genes:
PLA2G2A, HAS1, MFAP5, DPT, TNXB, CXCL14, PI16, FBLN2, OGN, ADH1B,
FBLN5.</p></li>
<li><p><strong>DECODER Immune compartment</strong> (408 genes, 60 in the
gene universe), reflecting B cell co-expression. Key genes: CR2, MS4A1,
TCL1A, CD19, FCER2.</p></li>
</ol>
<p>The original K=3 F1 combined these signatures into a single program
capturing iCAF + B cell + normal stroma biology. The question is whether
this combined program is robust across K and alpha.</p>
<hr />
<h2 id="the-master-table-icaf-coherence-across-k-x-alpha">The Master
Table: iCAF Coherence Across K x Alpha</h2>
<h3 id="training-n273">Training (n=273)</h3>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 2%" />
<col style="width: 5%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 13%" />
<col style="width: 14%" />
<col style="width: 13%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th>Fit</th>
<th>K</th>
<th>Alpha</th>
<th>iCAF Factor</th>
<th>H-cor</th>
<th>Gene Overlap</th>
<th>Elyada iCAF</th>
<th>DECODER Immune</th>
<th>Train HR (unadj)</th>
<th>Train HR (adj)</th>
<th>Train LRT p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K2_a0</td>
<td>2</td>
<td>0.00</td>
<td>F2</td>
<td>0.108</td>
<td>42/270</td>
<td>6/25 (24%)</td>
<td>4/60 (7%)</td>
<td>0.907 (p=0.20)</td>
<td>0.900 (p=0.21)</td>
<td>0.22</td>
</tr>
<tr class="even">
<td>K3_a0</td>
<td>3</td>
<td>0.00</td>
<td>F3</td>
<td>0.387</td>
<td>48/270</td>
<td>3/25 (12%)</td>
<td>0/60 (0%)</td>
<td>0.927 (p=0.40)</td>
<td>0.970 (p=0.74)</td>
<td>0.74</td>
</tr>
<tr class="odd">
<td>K5_a0</td>
<td>5</td>
<td>0.00</td>
<td>F1</td>
<td>0.313</td>
<td>47/270</td>
<td>3/25 (12%)</td>
<td>1/60 (2%)</td>
<td>0.969 (p=0.72)</td>
<td>0.972 (p=0.75)</td>
<td>0.75</td>
</tr>
<tr class="even">
<td>K2_a35</td>
<td>2</td>
<td>0.35</td>
<td>F2</td>
<td>0.518</td>
<td>61/270</td>
<td>7/25 (28%)</td>
<td>6/60 (10%)</td>
<td><strong>0.728 (p&lt;.0001)</strong></td>
<td><strong>0.760 (p=.001)</strong></td>
<td>0.002</td>
</tr>
<tr class="odd">
<td><strong>K3_a35</strong></td>
<td><strong>3</strong></td>
<td><strong>0.35</strong></td>
<td><strong>F1</strong></td>
<td><strong>0.731</strong></td>
<td><strong>132/270</strong></td>
<td>4/25 (16%)</td>
<td><strong>20/60 (33%)</strong></td>
<td><strong>0.601 (p&lt;.0001)</strong></td>
<td><strong>0.674 (p&lt;.0001)</strong></td>
<td><strong>8e-5</strong></td>
</tr>
<tr class="even">
<td>K5_a25</td>
<td>5</td>
<td>0.25</td>
<td>F4</td>
<td>0.449</td>
<td>121/270</td>
<td>6/25 (24%)</td>
<td><strong>27/60 (45%)</strong></td>
<td><strong>0.652 (p&lt;.0001)</strong></td>
<td><strong>0.767 (p=.007)</strong></td>
<td>0.008</td>
</tr>
<tr class="odd">
<td>K2_a55</td>
<td>2</td>
<td>0.55</td>
<td>F2</td>
<td>0.664</td>
<td>92/270</td>
<td>3/25 (12%)</td>
<td>10/60 (17%)</td>
<td><strong>0.634 (p&lt;.0001)</strong></td>
<td><strong>0.672 (p&lt;.0001)</strong></td>
<td><strong>2e-5</strong></td>
</tr>
<tr class="even">
<td><strong>K3_a55</strong></td>
<td><strong>3</strong></td>
<td><strong>0.55</strong></td>
<td><strong>F1</strong></td>
<td><strong>0.906</strong></td>
<td><strong>168/270</strong></td>
<td><strong>6/25 (24%)</strong></td>
<td>16/60 (27%)</td>
<td><strong>0.344 (p&lt;.0001)</strong></td>
<td><strong>0.371 (p&lt;.0001)</strong></td>
<td><strong>5e-18</strong></td>
</tr>
<tr class="odd">
<td>K5_a55</td>
<td>5</td>
<td>0.55</td>
<td>F4</td>
<td>0.737</td>
<td>146/270</td>
<td>6/25 (24%)</td>
<td>15/60 (25%)</td>
<td><strong>0.529 (p&lt;.0001)</strong></td>
<td><strong>0.562 (p&lt;.0001)</strong></td>
<td><strong>4e-9</strong></td>
</tr>
</tbody>
</table>
<h3 id="validation-n570-stratadataset">Validation (n=570,
strata(dataset))</h3>
<table style="width:100%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 2%" />
<col style="width: 6%" />
<col style="width: 11%" />
<col style="width: 15%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th>Fit</th>
<th>K</th>
<th>Alpha</th>
<th>iCAF Factor</th>
<th>Val HR (unadj)</th>
<th>Val HR (adj)</th>
<th>Val LRT p</th>
<th>Val KM High</th>
<th>Val KM Low</th>
<th>Val KM p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K2_a0</td>
<td>2</td>
<td>0.00</td>
<td>F2</td>
<td>1.018 (p=0.81)</td>
<td>0.953 (p=0.53)</td>
<td>0.54</td>
<td>22.5</td>
<td>21.0</td>
<td>0.13</td>
</tr>
<tr class="even">
<td>K3_a0</td>
<td>3</td>
<td>0.00</td>
<td>F3</td>
<td>0.902 (p=0.10)</td>
<td>0.926 (p=0.25)</td>
<td>0.26</td>
<td>24.8</td>
<td>19.2</td>
<td>0.003</td>
</tr>
<tr class="odd">
<td>K5_a0</td>
<td>5</td>
<td>0.00</td>
<td>F1</td>
<td>0.971 (p=0.65)</td>
<td>0.962 (p=0.57)</td>
<td>0.57</td>
<td>22.5</td>
<td>21.4</td>
<td>0.59</td>
</tr>
<tr class="even">
<td>K2_a35</td>
<td>2</td>
<td>0.35</td>
<td>F2</td>
<td>0.918 (p=0.28)</td>
<td>0.906 (p=0.24)</td>
<td>0.24</td>
<td>23.7</td>
<td>20.1</td>
<td>0.051</td>
</tr>
<tr class="odd">
<td><strong>K3_a35</strong></td>
<td><strong>3</strong></td>
<td><strong>0.35</strong></td>
<td><strong>F1</strong></td>
<td><strong>0.841 (p=.027)</strong></td>
<td>0.862 (p=.072)</td>
<td>0.075</td>
<td><strong>24.9</strong></td>
<td><strong>19.2</strong></td>
<td><strong>8e-4</strong></td>
</tr>
<tr class="even">
<td>K5_a25</td>
<td>5</td>
<td>0.25</td>
<td>F4</td>
<td><strong>0.797 (p=.0005)</strong></td>
<td>0.879 (p=.069)</td>
<td>0.072</td>
<td><strong>25.6</strong></td>
<td><strong>18.0</strong></td>
<td><strong>4e-6</strong></td>
</tr>
<tr class="odd">
<td>K2_a55</td>
<td>2</td>
<td>0.55</td>
<td>F2</td>
<td>0.876 (p=0.088)</td>
<td>0.891 (p=0.16)</td>
<td>0.16</td>
<td>24.1</td>
<td>20.1</td>
<td><strong>0.012</strong></td>
</tr>
<tr class="even">
<td><strong>K3_a55</strong></td>
<td><strong>3</strong></td>
<td><strong>0.55</strong></td>
<td><strong>F1</strong></td>
<td><strong>0.800 (p=.003)</strong></td>
<td>0.867 (p=.075)</td>
<td>0.076</td>
<td><strong>26.8</strong></td>
<td><strong>18.0</strong></td>
<td><strong>3e-4</strong></td>
</tr>
<tr class="odd">
<td>K5_a55</td>
<td>5</td>
<td>0.55</td>
<td>F4</td>
<td>0.884 (p=0.13)</td>
<td>0.888 (p=0.17)</td>
<td>0.17</td>
<td>25.3</td>
<td>19.2</td>
<td><strong>0.005</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="four-key-insights">Four Key Insights</h2>
<h3 id="the-survival-penalty-creates-the-icaf-program-validated">1. The
Survival Penalty Creates the iCAF Program (Validated)</h3>
<p>At alpha=0 (standard NMF), no K value recovers the iCAF program:</p>
<table>
<colgroup>
<col style="width: 3%" />
<col style="width: 35%" />
<col style="width: 25%" />
<col style="width: 22%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="header">
<th>K</th>
<th>Best iCAF H-cor at alpha=0</th>
<th>Train significant?</th>
<th>Val significant?</th>
<th>Val KM p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>0.108</td>
<td>No (p=0.20)</td>
<td>No (p=0.81)</td>
<td>0.13</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.387</td>
<td>No (p=0.40)</td>
<td>No (p=0.10)</td>
<td>0.003*</td>
</tr>
<tr class="odd">
<td>5</td>
<td>0.313</td>
<td>No (p=0.72)</td>
<td>No (p=0.65)</td>
<td>0.59</td>
</tr>
</tbody>
</table>
<p>*K3_a0’s validation KM p=0.003 despite the factor not being
prognostic in Cox models. This reflects a nonspecific stroma-vs-tumor
axis that separates by median split but doesn’t add information beyond
PurIST/DeCAF (adj p=0.25).</p>
<p>Standard NMF discovers variation-maximizing factors (the
stroma/basal-like axis, Classical tumor genes, immune programs as
separate compartments) but <strong>never combines them into the specific
iCAF + B cell + normal stroma program</strong> that the original K=3
Factor 1 captures.</p>
<p>The survival penalty (alpha &gt; 0) forces the factorization to
prioritize genes that jointly predict survival. This pulls iCAF, B cell,
and normal stroma genes – which individually explain modest variance but
collectively predict survival – into a single factor. <strong>The iCAF
program is a survival-selected gene program, not a variance-maximizing
one.</strong> This is the core methodological claim of DeSurv.</p>
<h3 id="k3-is-the-unique-rank-for-validated-icaf-isolation">2. K=3 Is
the Unique Rank for Validated iCAF Isolation</h3>
<p>At alpha=0.55 (the strongest comparable survival penalty), all three
K values recover <em>some</em> iCAF signal in training. But only K=3
validates:</p>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 27%" />
<col style="width: 27%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="header">
<th>Metric</th>
<th>K=2 (a=0.55)</th>
<th>K=3 (a=0.55)</th>
<th>K=5 (a=0.55)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H-cor with orig F1</td>
<td>0.664</td>
<td><strong>0.906</strong></td>
<td>0.737</td>
</tr>
<tr class="even">
<td>Gene overlap</td>
<td>92/270</td>
<td><strong>168/270</strong></td>
<td>146/270</td>
</tr>
<tr class="odd">
<td>Train HR (unadj)</td>
<td>0.634</td>
<td><strong>0.344</strong></td>
<td>0.529</td>
</tr>
<tr class="even">
<td><strong>Val HR (unadj)</strong></td>
<td>0.876 (p=0.088)</td>
<td><strong>0.800 (p=0.003)</strong></td>
<td>0.884 (p=0.13)</td>
</tr>
<tr class="odd">
<td><strong>Val KM gap</strong></td>
<td>4.0 mo (p=0.012)</td>
<td><strong>8.8 mo (p=3e-4)</strong></td>
<td>6.1 mo (p=0.005)</td>
</tr>
<tr class="even">
<td>Val LRT vs PurIST+DeCAF</td>
<td>0.16</td>
<td>0.076</td>
<td>0.17</td>
</tr>
<tr class="odd">
<td># sig factors (train)</td>
<td>2</td>
<td><strong>1</strong></td>
<td>3</td>
</tr>
<tr class="even">
<td>iCAF beta dominance</td>
<td>1.6x F1</td>
<td><strong>4.6x F2, 42x F3</strong></td>
<td>2.2x next</td>
</tr>
</tbody>
</table>
<p><strong>Why K=3 wins:</strong> - <strong>K=2 is too few</strong>: Two
factors cannot separate iCAF from the tumor subtype axis (Classical vs
Basal-like). F2 mixes iCAF + Classical tumor + Immune genes. Both
factors are prognostic, meaning iCAF signal is entangled with the
PurIST/DeCAF axis. <strong>Validation fails</strong> (unadj p=0.088, adj
p=0.16).</p>
<ul>
<li><p><strong>K=3 is just right</strong>: Three factors cleanly
separate (a) iCAF/immune/normal stroma, (b) basal-like tumor, (c)
stroma/classical tumor. Only the iCAF factor drives survival.
<strong>Validates unadjusted</strong> (p=0.003) with the largest KM gap
(8.8 months, p=3e-4).</p></li>
<li><p><strong>K=5 is too many</strong>: Five factors split the iCAF +
immune signal across multiple factors. Training is strong (3 prognostic
factors) but <strong>validation fails</strong> (unadj p=0.13). The
survival signal is spread too thin to replicate.</p></li>
</ul>
<h3 id="the-k5_a25-exception-reveals-the-immune-core">3. The K5_a25
Exception Reveals the Immune Core</h3>
<p>K5_a25 presents an interesting counterpoint: its iCAF factor (F4) has
the strongest unadjusted validation signal of any single fit (HR=0.797,
p=0.0005) and the best validation KM (25.6 vs 18.0, p=4.4e-6). But:</p>
<ul>
<li>Its H-correlation with the original iCAF program is only 0.449</li>
<li>It is a purer immune factor (45% DECODER Immune, 0% Basal
Tumor)</li>
<li>It does not survive PurIST+DeCAF adjustment (p=0.069)</li>
</ul>
<p>This suggests the <strong>immune component of Factor 1 is the primary
survival driver</strong>. K=5 at moderate alpha separates the immune
signal from iCAF/stroma, producing a cleaner immune factor that
validates strongly. But it’s not the full iCAF program. It is a fragment
of it that shares survival information with PurIST (which also captures
immune-related biology through the Basal-like vs Classical axis).</p>
<p>K=3 keeps immune + iCAF + normal stroma together, which is both more
coherent with the original program (rho=0.906 vs 0.449) and produces a
factor that remains prognostic (borderline) after PurIST+DeCAF
adjustment (p=0.075 vs 0.069). The K=3 program is thus both more
interpretable and more robust.</p>
<h3
id="the-alpha-x-k-interaction-reveals-survival-variance-competition">4.
The Alpha x K Interaction Reveals Survival-Variance Competition</h3>
<p>The full H-cor x K x alpha landscape reveals an interaction:</p>
<pre><code>                alpha=0.00    alpha~0.35    alpha=0.55
K=2              0.108         0.518         0.664
K=3              0.387         0.731         0.906  &lt;-- maximum coherence
K=5              0.313         0.449         0.737</code></pre>
<p>The validation landscape tells a different story:</p>
<pre><code>Val unadjusted p-value:
                alpha=0.00    alpha~0.35    alpha=0.55
K=2              0.81          0.28          0.088
K=3              0.10          0.027*        0.003**    &lt;-- validates
K=5              0.65          0.0005***     0.13       &lt;-- unstable</code></pre>
<p>Key patterns: - <strong>K=3 validates at both alpha levels</strong>
(p=0.027 and p=0.003). Robust. - <strong>K=5 validates at alpha=0.25 but
not alpha=0.55</strong>. The immune factor overfits at high alpha,
fragmenting across too many survival-weighted factors. - <strong>K=2
never validates</strong> (best is p=0.088). The iCAF signal is always
entangled with PurIST. - <strong>alpha=0 never validates</strong> for
any K. The survival penalty is necessary.</p>
<hr />
<h2 id="the-biological-interpretation">The Biological
Interpretation</h2>
<h3 id="what-the-icaf-program-is-at-k3-alpha0.35">What the iCAF program
IS (at K=3, alpha&gt;=0.35)</h3>
<p>The K=3 iCAF factor combines: 1. <strong>iCAF genes</strong> (Elyada:
PI16, CXCL14, DPT, CCDC80, FBLN2 / SCISSORS: PI16, CXCL14, DPT, OGN,
MFAP5, FBLN2, HAS1), chemokine-secreting fibroblasts 2. <strong>B cell /
immune genes</strong> (DECODER Immune: 16-27% overlap), tertiary
lymphoid structures 3. <strong>Normal stroma genes</strong> (DECODER
NormalStroma: 33-47% overlap), tissue homeostasis</p>
<p>This combination makes biological sense: iCAFs create chemokine
gradients (CCL19, CCL21, CXCL14) that recruit B cells and organize
tertiary lymphoid structures. Normal stroma provides the structural
scaffold. Together, they represent an <strong>organized immune
microenvironment</strong>, and its presence (high Factor 1 score) is
protective.</p>
<h3 id="what-the-icaf-program-is-not">What the iCAF program is NOT</h3>
<ul>
<li>It is NOT a variance-maximizing program (absent at alpha=0)</li>
<li>It is NOT a tumor subtype marker (PurIST captures that)</li>
<li>It is NOT an activated stroma marker (DeCAF/myCAF captures
that)</li>
<li>It is NOT a generic immune signature (K=5 separates “pure immune”
factors with 45% DECODER Immune overlap, but those are not the same
program)</li>
</ul>
<h3 id="why-it-adds-to-purist-decaf">Why it adds to PurIST + DeCAF</h3>
<p>PurIST classifies tumor cells (Basal-like vs Classical). DeCAF
classifies CAFs (proCAF vs restCAF). The iCAF program captures a third
axis: <strong>the organized immune microenvironment</strong> (iCAF + B
cell + normal stroma). This axis is: - Orthogonal to PurIST (not a tumor
subtype marker) - Orthogonal to DeCAF (not an activated/resting CAF
distinction) - The adjusted validation models show borderline
significance (p=0.075) with ntop=NULL. The original production fit with
focused ntop=270 achieved p=0.004.</p>
<hr />
<h2 id="comparison-to-previous-k-sensitivity-analysis">Comparison to
Previous K-Sensitivity Analysis</h2>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 45%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="header">
<th>Issue</th>
<th>Previous Analysis</th>
<th>This Analysis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hyperparameter comparability</td>
<td>K=2 used K=3’s params; K=5 used BO params with nu=0.005</td>
<td>Fixed lambda=0.3, nu=0.05, 100 inits for all</td>
</tr>
<tr class="even">
<td>Alpha range</td>
<td>Single alpha per K (BO-selected)</td>
<td>Grid: alpha=0, 0.25/0.35, 0.55 per K</td>
</tr>
<tr class="odd">
<td>Key confound</td>
<td>K=5’s nu=0.005 made it converge to std NMF</td>
<td>Eliminated: nu=0.05 everywhere</td>
</tr>
<tr class="even">
<td>External validation</td>
<td>K=2 had none; K=5 had paradoxical results</td>
<td>Full validation (n=570) for all 9 fits</td>
</tr>
<tr class="odd">
<td>iCAF at K=5</td>
<td>“Fragmented” but partly due to low nu</td>
<td>Still fragmented even with matched nu=0.05</td>
</tr>
<tr class="even">
<td>New insight</td>
<td>N/A</td>
<td>iCAF is alpha-dependent; absent at alpha=0 for all K</td>
</tr>
<tr class="odd">
<td>Validation finding</td>
<td>N/A</td>
<td>K=3 validates stably; K=5 validates only at alpha=0.25</td>
</tr>
</tbody>
</table>
<p>The previous conclusion that “K=3 is the right model” is
<strong>strengthened</strong>: even with fair hyperparameter matching
and comprehensive validation, K=3 uniquely isolates the iCAF program.
The new insights are: 1. This requires <strong>both</strong> K=3
<strong>and</strong> alpha &gt; 0 2. K=3 is the only rank that
<strong>validates stably</strong> across alpha values 3. K=5’s
validation instability (validates at alpha=0.25, fails at alpha=0.55)
further supports K=3 as the robust choice</p>
<hr />
<h2 id="implications-for-the-manuscript">Implications for the
Manuscript</h2>
<h3 id="for-the-main-text">For the main text</h3>
<p>The K-sensitivity analysis can be stated concisely: “We performed an
exhaustive grid search over K=2-12 and alpha=0-0.95 with all other
hyperparameters fixed. The iCAF/immune program (Factor 1) emerges only
with survival penalty (alpha &gt; 0) and is most coherent at K=3, where
it is the sole independently prognostic factor. At K=2, the iCAF program
is diluted by the tumor subtype axis and does not validate. At K=5, it
is fragmented across multiple factors with unstable validation. External
validation in 570 patients confirms K=3 Factor 1 as prognostic
(unadjusted HR=0.80, p=0.003; median-split KM 26.8 vs 18.0 months,
p=3e-4).”</p>
<h3 id="for-the-supplement">For the supplement</h3>
<p>The full K x alpha tables (training AND validation), the DECODER
compartment breakdowns, and the per-factor Cox models belong in the
supplement. The 9 cv_grid fits provide a controlled comparison that is
more defensible than the previous approach of comparing BO-optimized
fits with different hyperparameters.</p>
<h3 id="for-reviewer-response">For reviewer response</h3>
<p>The key defense against “why K=3?” is now: 1. Standard NMF at any K
does not find the iCAF program (alpha=0 row) 2. Among survival-penalized
fits, K=3 uniquely produces one coherent iCAF factor as the sole
survival signal 3. K=3 is the only rank that validates stably at both
tested alpha levels (unadjusted p=0.027 at alpha=0.35, p=0.003 at
alpha=0.55) 4. K=2 fails validation because iCAF is entangled with
PurIST 5. K=5 validation is unstable (validates at alpha=0.25 but with a
purer immune factor that only captures rho=0.449 of the iCAF program;
fails at alpha=0.55) 6. This is not an artifact of hyperparameter
selection; it holds across controlled grid search with fixed lambda, nu,
and initialization count</p>
<hr />
<h2 id="methodological-note-ntopnull-vs-ntop270">Methodological Note:
ntop=NULL vs ntop=270</h2>
<p>The cv_grid fits use ntop=NULL, meaning H-scores are computed as H =
X^T W using all 1970 genes. The original production fit used ntop=270,
focusing each factor’s H-score on its top 270 genes. This has
implications:</p>
<ul>
<li><strong>Training results are stronger with ntop=NULL</strong>
because the survival penalty has more genes to weight (K3_a55 HR=0.344
vs production HR~0.35)</li>
<li><strong>Validation adjusted models are weaker</strong> because using
all genes dilutes the per-factor signal (adj p=0.075 vs production adj
p=0.004)</li>
<li><strong>Unadjusted and KM results are robust</strong> and clearly
confirm the patterns</li>
<li>The ntop=NULL results are <strong>conservative</strong> for the
adjusted analysis. The production fit with focused ntop=270 would show
stronger adjusted validation</li>
</ul>
<hr />
<h2 id="data-provenance">Data Provenance</h2>
<p>All fits from:
<code>store_PKG_VERSION=20260107bugfix_GIT_BRANCH=main</code></p>
<table>
<thead>
<tr class="header">
<th>Fit</th>
<th>Branch Hash</th>
<th>K</th>
<th>Alpha</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K2_a0</td>
<td><code>cv_grid_fit_083dae3cd3bba1c5</code></td>
<td>2</td>
<td>0.00</td>
</tr>
<tr class="even">
<td>K3_a0</td>
<td><code>cv_grid_fit_22ac9cbd8337ebdf</code></td>
<td>3</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td>K5_a0</td>
<td><code>cv_grid_fit_128a06d24f80875e</code></td>
<td>5</td>
<td>0.00</td>
</tr>
<tr class="even">
<td>K2_a35</td>
<td><code>cv_grid_fit_e675ee353d14ef89</code></td>
<td>2</td>
<td>0.35</td>
</tr>
<tr class="odd">
<td>K2_a55</td>
<td><code>cv_grid_fit_7ced5aaef3b594d7</code></td>
<td>2</td>
<td>0.55</td>
</tr>
<tr class="even">
<td>K3_a35</td>
<td><code>cv_grid_fit_1555a2f1fcc58ab2</code></td>
<td>3</td>
<td>0.35</td>
</tr>
<tr class="odd">
<td>K3_a55</td>
<td><code>cv_grid_fit_ce943309f0b3e212</code></td>
<td>3</td>
<td>0.55</td>
</tr>
<tr class="even">
<td>K5_a25</td>
<td><code>cv_grid_fit_5c725504aa99734e</code></td>
<td>5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>K5_a55</td>
<td><code>cv_grid_fit_ed2d68b41575585f</code></td>
<td>5</td>
<td>0.55</td>
</tr>
</tbody>
</table>
<p>Grid parameters: lambda=0.3, nu=0.05, lambdaW=0, lambdaH=0, 100
initializations (CV_GRID_NSTARTS_FULL), ngene=3000 (-&gt;1970 after
filtering), 5-fold stratified CV (seed=123).</p>
<p>Original production fit: alpha=0.334, lambda=0.349, nu=0.056,
ntop=270, 200+ consensus seed initializations.</p>
<p>Training cohort: TCGA-PAAD (n=144) + CPTAC-PDAC (n=129) = 273
samples. Validation cohort: Dijk (n=90) + Moffitt GEO array (n=123) +
Puleo array (n=288) + PACA-AU (n=69) = 570 samples.</p>
<hr />
<h2 id="how-to-proceed-with-the-paper">How to Proceed with the
Paper</h2>
<h3 id="decision-point-1-which-fit-anchors-the-paper">Decision Point 1:
Which fit anchors the paper?</h3>
<p>The paper currently uses the <strong>production BO fit</strong>
(alpha=0.334, ntop=270) for all main results. The cv_grid analysis is a
<strong>sensitivity analysis</strong>, not a replacement. Two
options:</p>
<p><strong>Option A (Recommended): Keep the production fit as primary,
add cv_grid as supplement sensitivity analysis.</strong> - The
production fit has the strongest adjusted validation (p=0.004 with
ntop=270) - The cv_grid analysis answers “what if we controlled all
hyperparameters?” – a supplementary question - The main text adds one
paragraph summarizing the grid search finding - A supplemental table
shows the full K x alpha training+validation results - Low risk: doesn’t
change any existing results or figures</p>
<p><strong>Option B: Replace the production fit with the cv_grid K3_a55
fit.</strong> - More defensible against “cherry-picked hyperparameters”
criticism - But weaker adjusted validation (p=0.075 vs p=0.004) because
ntop=NULL - Would require re-generating Factor 1 gene lists,
enrichments, and figures - High risk: major revision for marginal
benefit</p>
<h3
id="decision-point-2-what-goes-in-the-main-text-vs-supplement">Decision
Point 2: What goes in the main text vs supplement?</h3>
<p><strong>Main text (1-2 paragraphs in Results):</strong> - “We
performed a controlled sensitivity analysis across K=2,3,5 and
alpha=0-0.55 with all other hyperparameters fixed (Supplementary Table
X).” - Key sentence: “The iCAF/immune program emerges only with survival
penalty (alpha&gt;0) and is most coherent and externally validated at
K=3.” - Cite the K3_a55 unadjusted validation (HR=0.80, p=0.003) and KM
gap (26.8 vs 18.0 months, p=3e-4) - Note that alpha=0 fails universally,
K=2 fails validation, K=5 is unstable</p>
<p><strong>Supplement:</strong> - Full K x alpha master table (training
+ validation columns) - Per-factor Cox tables for each of the 9 fits -
DECODER compartment breakdowns - The methodological note about ntop=NULL
vs ntop=270</p>
<h3
id="decision-point-3-how-to-frame-the-adjusted-validation-borderline">Decision
Point 3: How to frame the adjusted validation borderline?</h3>
<p>The cv_grid adjusted validation p-values (~0.075) are borderline.
Three framing strategies:</p>
<p><strong>Frame A: The conservative approach.</strong> “The iCAF factor
is independently prognostic unadjusted (p=0.003) and shows consistent
direction after PurIST+DeCAF adjustment (HR=0.87, p=0.075), with the
production fit’s focused gene selection achieving p=0.004 adjusted.”</p>
<p><strong>Frame B: The methodological defense.</strong> “The grid
search uses all 1970 genes (ntop=NULL) to ensure fair comparison across
K values; the production fit’s ntop=270 focuses H-scores on the most
informative genes per factor, yielding stronger adjusted validation
(p=0.004). The grid search confirms the program exists at K=3 but is
conservative for adjusted inference.”</p>
<p><strong>Frame C: Lead with KM (strongest result).</strong> “External
validation confirms the K=3 iCAF factor stratifies patients into
distinct prognostic groups (median OS 26.8 vs 18.0 months, p=3e-4 in 570
patients), consistent with the training separation (37.7 vs 13.3 months,
p=2e-13).” Then mention adjusted models as supportive context.</p>
<h3 id="decision-point-4-the-k5_a25-exception">Decision Point 4: The
K5_a25 exception</h3>
<p>K5_a25’s factor has the strongest individual unadjusted validation
signal (p=0.0005) and best KM (p=4.4e-6), but is a purer immune factor
(45% DECODER Immune, rho=0.449 with iCAF program). How to handle:</p>
<p><strong>Option A: Acknowledge and explain.</strong> “K=5 separates
the immune component that K=3 combines with iCAF and normal stroma. The
pure immune factor validates strongly but is less coherent with the
identified iCAF program and does not add to PurIST+DeCAF (adj
p=0.069).”</p>
<p><strong>Option B: Use it as supporting evidence.</strong> “The immune
component of Factor 1 drives the survival signal, as demonstrated by its
isolated recovery at K=5.”</p>
<h3 id="suggested-action-items">Suggested Action Items</h3>
<ol type="1">
<li><strong>Immediate</strong>: Decide between Option A and B for
Decision Point 1</li>
<li><strong>For the supplement</strong>: Generate the master table as a
formatted supplementary table (Supplementary Table X)</li>
<li><strong>For the main text</strong>: Draft 1-2 paragraphs summarizing
the sensitivity finding</li>
<li><strong>Optional</strong>: Re-run the cv_grid K3_a55 fit with
ntop=270 to see if adjusted validation strengthens. This would be a
single additional analysis that could close the adjusted p-value gap
while maintaining the controlled comparison.</li>
<li><strong>For the reviewer letter</strong>: Prepare the 6-point
defense (section above) as a template response to “why K=3?”</li>
</ol>
<h3 id="open-questions-for-discussion">Open Questions for
Discussion</h3>
<ol type="1">
<li>Should we run additional K values (K=4, K=6) to strengthen the “K=3
is optimal” claim, or is {2, 3, 5} sufficient?</li>
<li>Is the borderline adjusted validation (p=0.075) acceptable, or
should we pursue ntop=270 grid fits to sharpen it?</li>
<li>Should the K5_a25 “pure immune factor” finding be highlighted or
downplayed? It could strengthen the biological interpretation (the
immune component is the survival driver) but also invites the question
“why not use K=5?”</li>
</ol>
<hr />
<h2 id="glossary">Glossary</h2>
<ul>
<li><strong>H-score</strong>: Factor loading score for each sample,
computed as H = X^T W where X is the expression matrix and W is the
factor weight matrix. Measures how strongly each sample expresses a
given factor’s gene program.</li>
<li><strong>H-cor (H-score correlation)</strong>: Spearman rank
correlation between H-score vectors from two different fits. Used here
to compare each cv_grid factor against the original production K=3
factors. A value of 1.0 would mean identical sample rankings; 0 means
unrelated.</li>
<li><strong>LP (linear predictor)</strong>: The Cox model linear
predictor, sum of beta_k * H_k across factors. Summarizes each sample’s
predicted risk from the DeSurv model.</li>
<li><strong>LRT (likelihood ratio test)</strong>: Compares nested Cox
models. Here we test whether adding a factor’s H-score improves a model
already containing PurIST
<ul>
<li>DeCAF. A significant LRT means the factor adds prognostic
information beyond the existing classifiers.</li>
</ul></li>
<li><strong>ntop</strong>: Number of top genes per factor used to
compute H-scores. ntop=NULL means all 1970 genes are used; ntop=270
(production fit) focuses on each factor’s 270 highest-weight genes.
Using all genes is a more conservative test because it dilutes each
factor’s signal.</li>
<li><strong>strata(dataset)</strong>: Stratified Cox regression allowing
each validation cohort its own baseline hazard function while sharing
covariate effects across cohorts. This accounts for differences in
follow-up, patient selection, and platform effects across the 4
validation cohorts.</li>
<li><strong>Gene universe</strong>: The 1970 genes remaining after
variance and expression filtering from the initial 3000 (ngene=3000).
All gene overlap counts throughout these documents (e.g., “17 of 25
present in universe”) refer to genes present in this filtered set, not
the full genome.</li>
<li><strong>CV-optimal alpha</strong>: The alpha value that minimizes
cross-validated partial log-likelihood in the training data. For K=3,
this is alpha=0.55.</li>
<li><strong>Validation-optimal alpha</strong>: The alpha at which
external validation signal is strongest (by unadjusted Cox p-value). For
K=3, alpha=0.55 has the strongest validation; for K=5, alpha=0.25.</li>
<li><strong>PurIST</strong>: Single-sample classifier for PDAC tumor
subtypes (Basal-like vs Classical). Based on tumor cell gene
expression.</li>
<li><strong>DeCAF</strong>: Classifier for cancer-associated fibroblast
subtypes (proCAF vs restCAF). Based on CAF gene expression.</li>
<li><strong>DECODER</strong>: Deconvolution-based compartment classifier
from Peng et al. Provides Immune, BasalTumor, ClassicalTumor,
ActivatedStroma, and NormalStroma gene lists.</li>
</ul>
